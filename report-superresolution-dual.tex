\documentclass{paper}

%\usepackage{times}
\usepackage{epsfig}
\usepackage{graphicx}
\graphicspath{{superresolution/}{superresolution/output/}}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{color}
\usepackage{hyperref}
\usepackage[tight,footnotesize]{subfigure}

% load package with ``framed'' and ``numbered'' option.
%\usepackage[framed,numbered,autolinebreaks,useliterate]{mcode}

% something NOT relevant to the usage of the package.
\setlength{\parindent}{0pt}	
\setlength{\parskip}{18pt}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\twonorm}[1]{\left\lVert#1\right\rVert_2}
\usepackage[latin1]{inputenc} 
\usepackage[T1]{fontenc} 

\usepackage{listings} 
\lstset{% 
   language=Matlab, 
   basicstyle=\small\ttfamily, 
} 

\title{Assignment 2}



\author{Moser Stefan\\09-277-013}
% //////////////////////////////////////////////////


\begin{document}



\maketitle


% Add figures:
%\begin{figure}[t]
%%\begin{center}
%\quad\quad   \includegraphics[width=1\linewidth]{ass2}
%%\end{center}
%
%\label{fig:performance}
%\end{figure}

\section*{Superresolution}

\subsection*{Primal Dual formulation}
The energy term we need to minimize for this problem is

\begin{equation}
\min_{u \in U} \norm{\nabla u} + \frac{\lambda}{2} \norm{Du - g}^2
\label{eq:initial_energy}
\end{equation}
with $D$ being the downsampling operator that produces from the high 
resolution image $u$ (of size $M \times N$) a low level resolution image
(of size $\frac{M}{\alpha} \times \frac{N}{\alpha}$) by multiplying. 
For all images, we assume that they are given as vectors\footnote{following the flattening conventions of matlabs $(:)$ operator}.

So far, everything is the same as in the previous exercise. But instead of
solving Equation \ref{eq:initial_energy} directly, we will derive the primal-dual
formulation
\begin{equation}
\min_{u \in U} \max_{y \in Y} < Ku, y > - F^*(y) + G(u)
\label{eq:dual_energy}
\end{equation}
and solve it instead. All needed conditions are met:
\begin{itemize}
\item $F = \norm{\cdot}_2$ is a convex function
\item $G = \frac{\lambda}{2}\norm{ D\cdot - g}^2$ is a convex function
\item $K = \nabla \cdot$ is a linear operator
\end{itemize}
\subsubsection*{Legendre Fenchel Transform of TV term}
Since $F$ only appears as it's convex conjugate $F^*$ in Equation \ref{eq:dual_energy}, we need to compute it first.
\begin{align}
	F^*(y) &= (\norm{\cdot}_2)^*(y) \\
		  &= \sup_x x^T y - \twonorm{x} \\
		  &= \sup_x x^T y - \max_{\twonorm{z} \leq 1} x^T z \label{eq:cauchy_schwary}\\
		  &= \sup_x \min_{\twonorm{z} \leq 1} x^T(y-z) \\
		  &= \begin{cases}
   				0  			& \text{if} \twonorm{y} \leq 1 \\
   				\infty      & \text{otherwise}
  			 \end{cases} \label{eq:cases_F_star} \\
  	      &= \delta(y)
\end{align}
In step \ref{eq:cauchy_schwary} we used the Cauchy-Schwarz inequality
\begin{equation}
	\twonorm{x} = \max_{\twonorm{z} \leq 1} x^T z
\end{equation}
Further, the result in Equation \ref{eq:cases_F_star} can be derived by seeing that 
the inner minimum term always will be 0 in the first case, since then z will adapt to be
equal to y, resulting in the multiplication with a zero vector. If z can not be set equal
to y, i. e. $\twonorm{y} > 1$, the superior is unbound.

Consequently, the convex conjugate of the two norm is the \emph{unit ball indicator function}\footnote{1 if inside, $\infty$ if outside}.

We arrive at the Primal-Dual formulation for super resolution by simply putting our
results so far into Equation \ref{eq:dual_energy}.
\begin{equation}
\min_{u \in U} \max_{y \in Y} <\nabla u, y> - \delta(y) + \frac{\lambda}{2}\twonorm{Du - g}^2
\end{equation}

\subsection*{Primal-Dual steps}
Equation \ref{eq:dual_energy} can be solved using Primal-Dual steps. Specifically,
the following algorithm:
\begin{align}
	y^{n+1} &= prox_{\sigma F^*}(y^n + \sigma K \bar{x}^n) \\
	x^{n+1} &= prox_{\tau G}(x^n + \tau K^* y^{n+1}) \\
	\bar{x}^{n+1} &= x^{n+1} + \theta(x^{n+1} - x^n)
\end{align}
\subsection*{Implementation}

\subsubsection*{Iteration count}


\subsubsection*{Effect of Lambda}
TODO: SSD vs lambda

\subsubsection*{Optimal Lambda}

\subsection*{Conclusions}
Discuss two methods, compare with each other.
\end{document}
 
 